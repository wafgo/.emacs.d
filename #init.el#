(add-to-list 'load-path "~/.emacs.d/custom")
(add-to-list 'load-path "~/.emacs.d/github/snails")
(require 'package)
(setq package-enable-at-startup nil)
(add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/"))

;; Bootstrap `use-package'
(unless (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))

(require 'dashboard)
(require 'cmake-mode)
(require 'ninja-mode)
(require 'ccls)
(require 'setup-helm)
(require 'projectile)
(require 'lsp-mode)
(require 'lsp-ui)
(require 'shell-pop)
(require 'hungry-delete)
(require 'jump-char)
(require 'multiple-cursors)
(require 'smartparens-config)
(require 'expand-region)
(require 'conti-build-stuff)
(require 'dap-mode)
(require 'dap-ui)
(require 'dap-lldb)
;;(require 'dap-python)
(require 'debugging-stuff)
(require 'company)
(require 'helm-projectile)
(require 'wc-mode)
(require 'bb-mode)
;;(require 'sunrise)
(require 'helm-fasd)
(require 'whitespace)
(require 'e-byzanz)
(require 'google-translate)
(require 'google-translate-smooth-ui)
(require 'ein)
;;(require 'lsp-python-ms)
(require 'helm-system-packages)
(require 'helm-ls-git)
(require 'helm-dictionary)
(require 'helm-descbinds)
(require 'helm-fd)
(require 'snails)
(use-package pdf-view-restore
  :after pdf-tools
  :config
  (add-hook 'pdf-view-mode-hook 'pdf-view-restore-mode))


;;(require 'powerline)
;(powerline-default-theme)
;;(setq lsp-python-ms-auto-install-server t)
(use-package elpy
  :ensure t
  :init
  (elpy-enable))

(require 'sublimity)
(require 'yasnippet)
(require 'saveplace-pdf-view)
(save-place-mode 1)
;;(require 'sublimity-scroll)
;;(require 'sublimity-map) ;; experimental
;; (setq sublimity-scroll-weight 10
;;       sublimity-scroll-drift-length 5)
(setq snails-show-with-frame nil)
(helm-descbinds-mode)
(setq pdf-view-restore-filename "~/.emacs.d/.pdf-view-restore")
;;(require 'sublimity-attractive)

;;(setq evil-want-integration t) ;; This is optional since it's already set to t by default.
;;(setq evil-want-keybinding nil)
;; (setq evil-want-integration t) ;; This is optional since it's already set to t by default.
;; (setq evil-want-keybinding nil)
;; (require 'evil)
;; (when (require 'evil-collection nil t)
;;   (evil-collection-init))

;; ;;(require 'key-chord)
;; (evil-mode 1)
;; (evil-set-initial-state 'dired-mode 'emacs)
;; (evil-set-initial-state 'vterm-mode 'emacs)
;; ;;;(key-chord-mode 1)
;; (evil-collection-init)
;;(key-chord-define evil-insert-state-map  "jj" 'evil-normal-state)
(yas-global-mode 1)
;;(global-display-line-numbers-mode 1)
;;(setq display-line-numbers-type 'relative)
;; (with-eval-after-load 'lsp-mode
;;   ;; :global/:workspace/:file
;;   (setq lsp-modeline-diagnostics-scope :workspace))
;;(setq company-backends '((company-capf company-dabbrev-code)))
;;(require 'ein-notebook)
;; (setq ein:completion-backend 'ein:use-ac-jedi-backend)
;; (setq ein:use-auto-complete t)
(setq ztree-diff-additional-options '("-w" "-i"))
(when (and (string-match "0.12.0"
                         (google-translate-version))
           (>= (time-to-seconds)
               (time-to-seconds
                (encode-time 0 0 0 23 9 2018))))
  (defun google-translate--get-b-d1 ()
    ;; TKK='427110.1469889687'
    (list 427110 1469889687)))

(global-set-key "\C-ct" 'google-translate-at-point)

(autoload 'whitespace-mode           "whitespace" "Toggle whitespace visualization."        t)
(autoload 'whitespace-toggle-options "whitespace" "Toggle local `whitespace-mode' options." t)

(setq dap-auto-configure-features '(sessions locals controls tooltip))
;;(setq dap-auto-configure-mode t)
(setq-default tab-with 4)

(setq gdb-many-windows t
      gdb-use-separate-io-buffer t)
(advice-add 'gdb-setup-windows :after
            (lambda () (set-window-dedicated-p (selected-window) t)))
(defconst gud-window-register 123456)
 
(defun gud-quit ()
  (interactive)
  (gud-basic-call "quit"))
 
(add-hook 'gud-mode-hook
          (lambda ()
            (gud-tooltip-mode)
            (window-configuration-to-register gud-window-register)
            (local-set-key (kbd "C-q") 'gud-quit)))
 
(advice-add 'gud-sentinel :after
            (lambda (proc msg)
              (when (memq (process-status proc) '(signal exit))
                (jump-to-register gud-window-register)
                (bury-buffer))))

;;(global-fasd-mode 1)
(setq auto-mode-alist (cons '("\\.bb$" . bb-mode) auto-mode-alist))
(setq auto-mode-alist (cons '("\\.inc$" . bb-mode) auto-mode-alist))
(setq auto-mode-alist (cons '("\\.bbappend$" . bb-mode) auto-mode-alist))
(setq auto-mode-alist (cons '("\\.bbclass$" . bb-mode) auto-mode-alist))
(setq auto-mode-alist (cons '("\\.conf$" . bb-mode) auto-mode-alist))

(setq ccls-executable "/home/local/devel/github/ccls/build/ccls")
(defun ccls/callee () (interactive) (lsp-ui-peek-find-custom "$ccls/call" '(:callee t)))
(defun ccls/caller () (interactive) (lsp-ui-peek-find-custom "$ccls/call"))
(defun ccls/vars (kind) (lsp-ui-peek-find-custom "$ccls/vars" `(:kind ,kind)))
(defun ccls/base (levels) (lsp-ui-peek-find-custom "$ccls/inheritance" `(:levels ,levels)))
(defun ccls/derived (levels) (lsp-ui-peek-find-custom "$ccls/inheritance" `(:levels ,levels :derived t)))
(defun ccls/member (kind) (interactive) (lsp-ui-peek-find-custom "$ccls/member" `(:kind ,kind)))

;; References w/ Role::Role
(defun ccls/references-read () (interactive)
  (lsp-ui-peek-find-custom "textDocument/references"
    (plist-put (lsp--text-document-position-params) :role 8)))

;; References w/ Role::Write
(defun ccls/references-write ()
  (interactive)
  (lsp-ui-peek-find-custom "textDocument/references"
   (plist-put (lsp--text-document-position-params) :role 16)))

;; References w/ Role::Dynamic bit (macro expansions)
(defun ccls/references-macro () (interactive)
  (lsp-ui-peek-find-custom "textDocument/references"
   (plist-put (lsp--text-document-position-params) :role 64)))

;; References w/o Role::Call bit (e.g. where functions are taken addresses)
(defun ccls/references-not-call () (interactive)
  (lsp-ui-peek-find-custom "textDocument/references"
   (plist-put (lsp--text-document-position-params) :excludeRole 32)))

(setq lsp-ui-doc-include-signature nil)  ; don't include type signature in the child frame
(setq lsp-ui-sideline-show-symbol nil)  ; don't show symbol on the right of info

;;(setq ccls-sem-highlight-method 'font-lock)
(setq ccls-sem-highlight-method 'overlay)

(dashboard-setup-startup-hook)
(setq dashboard-items '((recents  . 5)
                        (bookmarks . 15)
                        (projects . 2)
                        (agenda . 0)
                        (registers . 2)))
;; ; add MELPA to repository list
;; (add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/"))
;; ; initialize package.el
;; (package-initialize)
;; (unless (package-installed-p 'use-package)
;;   (package-install 'use-package))

(setq auto-mode-alist (cons '("\\.cmk$" . cmake-mode) auto-mode-alist))
(add-to-list 'auto-mode-alist '("\\.desf\\'" . tar-mode))
;; (require 'use-package)
(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(c-default-style
   '((c-mode . "cc-mode")
     (java-mode . "java")
     (awk-mode . "awk")
     (other . "gnu")))
 '(ccls-executable "/home/local/devel/github/ccls/build/ccls")
 '(company-idle-delay 0.0)
 '(company-lsp-cache-candidates 'auto)
 '(company-minimum-prefix-length 1)
 '(custom-safe-themes
   '("f2c35f8562f6a1e5b3f4c543d5ff8f24100fae1da29aeb1864bbc17758f52b70" default))
 '(dap-auto-configure-features '(sessions locals breakpoints expressions controls tooltip))
 '(dap-internal-terminal 'dap-internal-terminal-vterm)
 '(dap-lldb-debug-program '("lldb-vscode"))
 '(dap-print-io nil)
 '(dap-tooltip-mode t)
 '(elpy-rpc-ignored-buffer-size 110400)
 '(elpy-rpc-timeout 10)
 '(evil-collection-setup-minibuffer t)
 '(evil-emacs-state-modes
   '(n5x5-mode archive-mode bbdb-mode biblio-selection-mode blackbox-mode bookmark-bmenu-mode bookmark-edit-annotation-mode browse-kill-ring-mode bs-mode bubbles-mode bzr-annotate-mode calc-mode cfw:calendar-mode completion-list-mode Custom-mode custom-theme-choose-mode debugger-mode delicious-search-mode desktop-menu-blist-mode desktop-menu-mode doc-view-mode dun-mode dvc-bookmarks-mode dvc-diff-mode dvc-info-buffer-mode dvc-log-buffer-mode dvc-revlist-mode dvc-revlog-mode dvc-status-mode dvc-tips-mode ediff-mode ediff-meta-mode efs-mode Electric-buffer-menu-mode emms-browser-mode emms-mark-mode emms-metaplaylist-mode emms-playlist-mode ess-help-mode etags-select-mode fj-mode gc-issues-mode gdb-breakpoints-mode gdb-disassembly-mode gdb-frames-mode gdb-locals-mode gdb-memory-mode gdb-registers-mode gdb-threads-mode gist-list-mode git-rebase-mode gnus-article-mode gnus-browse-mode gnus-group-mode gnus-server-mode gnus-summary-mode gomoku-mode google-maps-static-mode ibuffer-mode jde-javadoc-checker-report-mode magit-cherry-mode magit-diff-mode magit-log-mode magit-log-select-mode magit-popup-mode magit-popup-sequence-mode magit-process-mode magit-reflog-mode magit-refs-mode magit-revision-mode magit-stash-mode magit-stashes-mode magit-status-mode mh-folder-mode monky-mode mpuz-mode mu4e-main-mode mu4e-headers-mode mu4e-view-mode notmuch-hello-mode notmuch-search-mode notmuch-show-mode notmuch-tree-mode occur-mode org-agenda-mode package-menu-mode proced-mode rcirc-mode rebase-mode recentf-dialog-mode reftex-select-bib-mode reftex-select-label-mode reftex-toc-mode sldb-mode slime-inspector-mode slime-thread-control-mode slime-xref-mode snake-mode solitaire-mode sr-buttons-mode sr-mode sr-tree-mode sr-virtual-mode tar-mode tetris-mode tla-annotate-mode tla-archive-list-mode tla-bconfig-mode tla-bookmarks-mode tla-branch-list-mode tla-browse-mode tla-category-list-mode tla-changelog-mode tla-follow-symlinks-mode tla-inventory-file-mode tla-inventory-mode tla-lint-mode tla-logs-mode tla-revision-list-mode tla-revlog-mode tla-tree-lint-mode tla-version-list-mode twittering-mode urlview-mode vc-annotate-mode vc-dir-mode vc-hg-log-view-mode vc-svn-log-view-mode vm-mode vm-summary-mode w3m-mode wab-compilation-mode xgit-annotate-mode xgit-changelog-mode xgit-diff-mode xgit-revlog-mode xhg-annotate-mode xhg-log-mode xhg-mode xhg-mq-mode xhg-mq-sub-mode xhg-status-extra-mode))
 '(evil-want-C-u-scroll t)
 '(google-translate-default-source-language "en")
 '(google-translate-default-target-language "de")
 '(helm-autoresize-mode nil)
 '(helm-candidate-number-limit 200)
 '(helm-completion-style 'emacs)
 '(helm-dictionary-database "/home/local/devel/de-en/de-en.txt")
 '(helm-minibuffer-history-key "M-p")
 '(helm-rg-default-directory 'git-root)
 '(helm-rg-default-extra-args nil)
 '(lsp-eldoc-enable-hover nil)
 '(lsp-enable-file-watchers nil)
 '(lsp-enable-snippet t)
 '(lsp-enable-symbol-highlighting t)
 '(lsp-headerline-breadcrumb-enable t)
 '(lsp-lens-enable nil)
 '(lsp-modeline-diagnostics-enable t)
 '(lsp-print-performance nil)
 '(lsp-pyls-plugins-flake8-enabled t)
 '(lsp-pyls-plugins-jedi-completion-fuzzy t)
 '(lsp-ui-doc-show-with-cursor t)
 '(lsp-ui-sideline-diagnostic-max-line-length 100)
 '(lsp-ui-sideline-show-code-actions t)
 '(lsp-ui-sideline-show-hover t)
 '(lsp-ui-sideline-show-symbol t)
 '(message-log-max 100000)
 '(package-selected-packages
   '(saveplace-pdf-view pdf-view-restore helm-wikipedia helm-descbinds helm-dictionary helm-ls-git evil-collection evil-escape evil elpy yasnippet-snippets helm-system-packages helm-c-yasnippet lsp-python-ms goto-last-change smart-hungry-delete company-jedi lsp-jedi jedi ein jupyter ztree google-translate 0xc meson-mode undo-tree camcorder command-log-mode minimap posframe dap-mode fasd dts-mode bison-mode bitbake company-lsp ninja-mode multi-vterm vterm-toggle vtm yasnippet-classic-snippets vterm helm-lsp smartscan expand-region vlf smartparens pdf-tools beacon ccls zenburn-theme ace-jump-mode jump-char helm-swoop swoop multiple-cursors hungry-delete shell-pop flycheck lsp-ui lsp-mode helm-dash cmake-mode dashboard helm-projectile projectile magit helm-rg helm))
 '(projectile-git-command "git ls-files -zco --exclude-standard")
 '(projectile-globally-ignored-directories
   '(".idea" ".vscode" ".ensime_cache" ".eunit" ".git" ".hg" ".fslckout" "_FOSSIL_" ".bzr" "_darcs" ".tox" ".svn" ".stack-work" ".ccls-cache" ".clangd"))
 '(projectile-indexing-method 'alien)
 '(shell-pop-term-shell "/bin/bash")
 '(smerge-command-prefix "v")
 '(sr-show-hidden-files t)
 '(sr-terminal-program "vterm")
 '(sublimity-mode t)
 '(sunrise-listing-switches "-al --group-directories-first")
 '(vterm-buffer-name-string "vterm %s")
 '(vterm-enable-manipulate-selection-data-by-osc52 nil)
 '(vterm-shell "/bin/bash")
 '(warning-suppress-types '((comp) (comp) (comp) (comp) (comp)))
 '(winner-mode t))
(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(lsp-face-highlight-read ((t (:inherit highlight :underline t))))
 '(lsp-face-highlight-textual ((t (:inherit highlight))))
 '(ztreep-diff-model-add-face ((t (:foreground "green"))))
 '(ztreep-diff-model-diff-face ((t (:foreground "dark orange")))))
(setq projectile-switch-project-action 'helm-projectile)
(helm-projectile-on)

(add-hook 'after-init-hook 'global-company-mode)
(define-key c-mode-base-map (kbd "<C-tab>") (function company-complete))

(global-set-key (kbd "C-w") 'backward-kill-word)
(if (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))
(if (fboundp 'tool-bar-mode) (tool-bar-mode -1))
(if (fboundp 'menu-bar-mode) (menu-bar-mode -1))

(setq dired-dwim-target t)
(setq dired-listing-switches "--group-directories-first -al")
(eval-after-load "dired" '(progn
                            (define-key dired-mode-map "F" 'find-name-dired)
                            (define-key dired-mode-map "a"
                              (lambda ()
                                (interactive)
                                (find-alternate-file "..")))
                            ))

(define-key lsp-mode-map [remap xref-find-apropos] #'helm-lsp-workspace-symbol)
(global-set-key (kbd "C-=") 'er/expand-region)

(add-hook 'prog-mode-hook 'smartscan-mode)

(defalias 'yes-or-no-p 'y-or-n-p)
(use-package projectile
  :init
  (projectile-global-mode)
  (setq projectile-enable-caching t))

(use-package vterm
  :ensure t)

(use-package multi-vterm :ensure t)
(global-set-key (kbd "C-ü") 'vterm-toggle-cd)
(setq vterm-toggle-fullscreen-p nil)
;Switch to next vterm buffer
(define-key vterm-mode-map (kbd "s-n")   'vterm-toggle-forward)
;Switch to previous vterm buffer
(define-key vterm-mode-map (kbd "s-p")   'vterm-toggle-backward)
(define-key vterm-mode-map (kbd "s-y")   'vterm-yank-pop)
(add-to-list 'display-buffer-alist
             '((lambda(bufname _) (with-current-buffer bufname (equal major-mode 'vterm-mode)))
                (display-buffer-reuse-window display-buffer-at-bottom)
                ;;(display-buffer-reuse-window display-buffer-in-direction)
                ;;display-buffer-in-direction/direction/dedicated is added in emacs27
                ;;(direction . bottom)
                ;;(dedicated . t) ;dedicated is supported in emacs27
                (reusable-frames . visible)
                (window-height . 0.3)))

(defun sudo-find-file (file-name)
  "Like find file, but opens the file as root."
  (interactive "FSudo Find File: ")
  (let ((tramp-file-name (concat "/sudo::" (expand-file-name file-name))))
    (find-file tramp-file-name)))

;; activate whitespace-mode to view all whitespace characters
(global-set-key (kbd "C-c w") 'whitespace-mode)
(windmove-default-keybindings)

(beacon-mode 1)

(define-key lsp-ui-mode-map [remap xref-find-definitions] #'lsp-ui-peek-find-definitions)
(define-key lsp-ui-mode-map [remap xref-find-references] #'lsp-ui-peek-find-references)
(define-key lsp-ui-mode-map (kbd "C-x C-p") 'lsp-ui-find-prev-reference)
(define-key lsp-ui-mode-map (kbd "C-x C-n") 'lsp-ui-find-next-reference)
(define-key lsp-ui-mode-map (kbd "C-M-i") 'lsp-ui-imenu)
(define-key lsp-ui-mode-map (kbd "C-.") 'helm-lsp-workspace-symbol)
(define-key lsp-ui-mode-map (kbd "C-c c") 'ccls-call-hierarchy)

(add-hook 'lsp-mode-hook 'lsp-ui-mode)

(add-hook 'c-mode-common-hook #'lsp)
;;(add-hook 'python-mode-hook #'lsp)
(add-hook 'sh-mode-hook #'lsp)
(add-hook 'cmake-mode-hook #'lsp)
(add-hook 'cmake-mode-hook #'smartparens-mode)
(add-hook 'prog-mode-hook #'smartparens-mode)
(pdf-tools-install)
(global-hungry-delete-mode)
(global-set-key (kbd "C-S-c C-S-c") 'mc/edit-lines)
(global-set-key (kbd "C-<") 'mc/mark-next-like-this)
(global-set-key (kbd "C->") 'mc/mark-previous-like-this)
(global-set-key (kbd "C-c C-<") 'mc/mark-all-like-this)
(define-key global-map (kbd "C-j") 'ace-jump-mode)

(defvar wmu-keys-minor-mode-map
(let ((map (make-sparse-keymap)))
  (define-key map "\C-x\C-m" 'helm-M-x)
  (define-key map "\C-c\C-m" 'helm-M-x)
  (define-key map "\C-x\C-k" 'kill-region)
  (define-key map (kbd "M-i") 'helm-swoop)
  (define-key map (kbd "C-x g") 'magit-status)
  (define-key map (kbd "C-x M-g") 'magit-dispatch-popup)
  (define-key map (kbd "C-ö") 'helm-mini)
  (define-key map (kbd "C-M-ö") 'helm-projectile-switch-to-buffer)
  (define-key map (kbd "C-M-ä") 'helm-rg)
  (define-key map (kbd "C-c C-j") 'yas-insert-snippet)
  (define-key map (kbd "C-c C-k") 'term-char-mode)
  (define-key map (kbd "M-ä") 'helm-projectile-rg)
  (define-key map (kbd "M-ö") 'helm-projectile-find-file-dwim)
  (define-key map (kbd "C-M-j") 'next-buffer)
  (define-key map (kbd "C-M-l") 'previous-buffer)
  (define-key map (kbd "C-S-j") 'multi-vterm-next)
  (define-key map (kbd "C-S-l") 'multi-vterm-prev)
  (define-key map (kbd "M-o") 'mode-line-other-buffer)
  (define-key map (kbd "C-x b") 'helm-bookmarks)
  (define-key map (kbd "M-q") 'helm-fasd)
  (define-key map (kbd "M-j") 'helm-browse-project)
  (define-key map (kbd "C-x C-d") 'helm-browse-project)
  (define-key map (kbd "C-x r p") 'helm-projects-history)
  (define-key map (kbd "C-c l") 'linum-mode)
  map)
"wmu-keys-minor-mode keymap.")

(define-minor-mode wmu-keys-minor-mode
"A minor mode so that my key settings override annoying major modes."
:init-value t
:lighter " wmu-keys")

(wmu-keys-minor-mode 1)
(load-theme 'zenburn t)

(add-to-list 'default-frame-alist '(fullscreen . maximized))
(setq compilation-scroll-output 'first-error)
(defun smarter-move-beginning-of-line (arg)
  "Move point back to indentation of beginning of line.

Move point to the first non-whitespace character on this line.
If point is already there, move to the beginning of the line.
Effectively toggle between the first non-whitespace character and
the beginning of the line.

If ARG is not nil or 1, move forward ARG - 1 lines first.  If
point reaches the beginning or end of the buffer, stop there."
  (interactive "^p")
  (setq arg (or arg 1))

  ;; Move lines first
  (when (/= arg 1)
    (let ((line-move-visual nil))
      (forward-line (1- arg))))

  (let ((orig-point (point)))
    (back-to-indentation)
    (when (= orig-point (point))
      (move-beginning-of-line 1))))

;; remap C-a to `smarter-move-beginning-of-line'
(global-set-key [remap move-beginning-of-line]
                'smarter-move-beginning-of-line)

(setq backup-directory-alist '(("" . "~/.emacs.d/backup")))
(setq history-delete-duplicates t)
(add-to-list 'display-buffer-alist (cons "\\*Async Shell Command\\*.*" (cons #'display-buffer-no-window nil)))

(defun lsp-action-retrieve-and-run ()
  "Retrieve, select, and run code action."
  (interactive)
  (lsp--cur-workspace-check)
  (lsp--send-request-async (lsp--make-request
                            "textDocument/codeAction"
                            (lsp--text-document-code-action-params))
                           (lambda (actions)
                             (setq lsp-code-actions actions)
                             (condition-case nil
                                 (call-interactively 'lsp-execute-code-action)
                               (quit "Quit")))))

(setq shell-file-name "/bin/bash")
(setq gc-cons-threshold 100000000)
(setq read-process-output-max (* 1024 1024)) ;; 1mb
(setq c-default-style "linux" c-basic-offset 4)
(setq-default indent-tabs-mode nil)


(defun show-hexadecimal-value ()
  "Prints the decimal value of a hexadecimal string under cursor.

Samples of valid input:

  ffff → 65535
  0xffff → 65535
  #xffff → 65535
  FFFF → 65535
  0xFFFF → 65535
  #xFFFF → 65535

more test cases
  64*0xc8+#x12c 190*0x1f4+#x258
  100 200 300   400 500 600

URL `http://ergoemacs.org/emacs/elisp_converting_hex_decimal.html'
Version 2020-02-17"
  (interactive )
  (let ($inputStr $tempStr $p1 $p2 )
    (if (region-active-p)
        (progn
          (setq $p1 (region-beginning))
          (setq $p2 (region-end)))
      (progn
        (save-excursion
          (skip-chars-backward "0123456789abcdefABCDEF#x")
          (setq $p1 (point))
          (skip-chars-forward "0123456789abcdefABCDEF#x" )
          (setq $p2 (point)))))
    (setq $inputStr (buffer-substring-no-properties $p1 $p2))
    (let ((case-fold-search nil))
      (setq $tempStr (replace-regexp-in-string "\\`0x" "" $inputStr )) ; C, Perl, …
      (setq $tempStr (replace-regexp-in-string "\\`#x" "" $tempStr )) ; elisp …
      (setq $tempStr (replace-regexp-in-string "\\`#" "" $tempStr )) ; CSS …
      )
    (message "input 「%s」, Hexadecimal 「%s」 is 「%d」" $inputStr $tempStr (string-to-number $tempStr 16))))
(setq elpy-rpc-timeout 50)
(setq ztree-diff-options '("-w" "-i" "--strip-trailing-cr"))
